<div class="catalog-page">
  <!-- Navbar - Light theme matching landing page -->
  <nav class="navbar" id="navbar">
    <div class="nav-container">
      <div class="nav-logo">
        <%= link_to root_path, class: "logo-link" do %>
          <%= image_tag "vega-logo.png", alt: @site_info["site_name"], class: "logo-icon" %>
          <span class="logo-text"><%= @site_info["site_name"]&.upcase %></span>
        <% end %>
      </div>
      
      <ul class="nav-menu" id="navMenu">
        <li><%= link_to "Home", root_path, class: "nav-link" %></li>
        <li><%= link_to "Products", products_path, class: "nav-link" %></li>
        <li><%= link_to "Categories", categories_path, class: "nav-link active" %></li>
        <li><a href="<%= root_path %>#contact" class="nav-link cta-button">Contact Us</a></li>
      </ul>
      
      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </nav>

  <!-- Category Filter Pills - Below Navbar -->
  <section class="category-filters">
    <div class="filters-container">
      <div class="filter-pills">
        <%= link_to "All Products", products_path, class: "filter-pill" %>
        <% Category.roots.active.ordered.limit(8).each do |cat| %>
          <%= link_to cat.name, category_path(cat.slug), 
              class: "filter-pill #{cat.id == @category.id || cat.id == @category.parent_id ? 'active' : ''}" %>
        <% end %>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <main class="catalog-content">
    <section class="filtered-results">
      <div class="results-header">
        <h1>
          <span class="category-icon"><%= @category.icon.presence || "üì¶" %></span>
          <%= @category.name %>
        </h1>
        <span class="results-count"><%= @products.count %> products found</span>
      </div>

      <% if @subcategories.any? %>
        <div class="subcategory-pills" style="margin-bottom: 1.5rem;">
          <% @subcategories.each do |sub| %>
            <%= link_to category_path(sub.slug), class: "filter-pill" do %>
              <%= sub.icon.presence || "üìÅ" %> <%= sub.name %> (<%= sub.products.published.count %>)
            <% end %>
          <% end %>
        </div>
      <% end %>
      
      <% if @products.any? %>
        <div class="products-grid">
          <% @products.each do |product| %>
            <%= render partial: "products/product_card", locals: { product: product } %>
          <% end %>
        </div>
      <% else %>
        <div class="no-results">
          <span class="emoji">üîç</span>
          <h3>No products found</h3>
          <p>Try browsing subcategories or view all products</p>
          <%= link_to "View All Products", products_path, class: "btn btn-primary" %>
        </div>
      <% end %>
    </section>
  </main>

  <%= render partial: "shared/catalog_footer_light" %>
</div>

<script>
  const hamburger = document.getElementById('hamburger');
  const navMenu = document.getElementById('navMenu');
  if (hamburger && navMenu) {
    hamburger.addEventListener('click', () => {
      navMenu.classList.toggle('active');
      hamburger.classList.toggle('active');
    });
  }
</script>
