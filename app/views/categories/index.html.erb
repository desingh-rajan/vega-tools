<div class="catalog-page">
  <!-- Navbar - Light theme matching landing page -->
  <nav class="navbar" id="navbar">
    <div class="nav-container">
      <div class="nav-logo">
        <%= link_to root_path, class: "logo-link" do %>
          <%= image_tag "vega-logo.png", alt: @site_info["site_name"], class: "logo-icon" %>
          <span class="logo-text"><%= @site_info["site_name"]&.upcase %></span>
        <% end %>
      </div>
      
      <ul class="nav-menu" id="navMenu">
        <li><%= link_to "Home", root_path, class: "nav-link" %></li>
        <li><%= link_to "Products", products_path, class: "nav-link" %></li>
        <li><%= link_to "Categories", categories_path, class: "nav-link active" %></li>
        <li><a href="<%= root_path %>#contact" class="nav-link cta-button">Contact Us</a></li>
      </ul>
      
      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </nav>

  <!-- Category Filter Pills -->
  <section class="category-filters">
    <div class="filters-container">
      <div class="filter-pills">
        <%= link_to "All Products", products_path, class: "filter-pill" %>
        <% @categories.limit(8).each do |cat| %>
          <%= link_to cat.name, category_path(cat.slug), class: "filter-pill" %>
        <% end %>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <main class="catalog-content">
    <section class="filtered-results">
      <div class="results-header">
        <h1>ðŸ“‚ Product Categories</h1>
        <span class="results-count"><%= @categories.count %> categories â€¢ <%= Product.published.count %> products</span>
      </div>

      <% if @categories.any? %>
        <div class="categories-grid-light">
          <% @categories.each do |category| %>
            <%= link_to category_path(category.slug), class: "category-card-light" do %>
              <div class="category-icon-wrapper">
                <% if category.icon_image.attached? %>
                  <% begin %>
                    <%= image_tag category.icon_image.variant(resize_to_fill: [80, 80]), alt: category.name, class: "category-image" %>
                  <% rescue %>
                    <span class="category-emoji"><%= category.icon.presence || "ðŸ“¦" %></span>
                  <% end %>
                <% else %>
                  <span class="category-emoji"><%= category.icon.presence || "ðŸ“¦" %></span>
                <% end %>
              </div>
              <div class="category-content">
                <h3 class="category-name"><%= category.name %></h3>
                <div class="category-stats">
                  <span class="stat"><%= category.all_products.published.count %> products</span>
                  <% if category.children.any? %>
                    <span class="stat"><%= category.children.count %> subcategories</span>
                  <% end %>
                </div>
              </div>
              <span class="category-arrow">â†’</span>
            <% end %>
          <% end %>
        </div>
      <% else %>
        <div class="no-results">
          <span class="emoji">ðŸ“‚</span>
          <h3>No categories yet</h3>
          <p>Check back soon for our product categories</p>
          <%= link_to "Browse All Products", products_path, class: "btn btn-primary" %>
        </div>
      <% end %>
    </section>
  </main>

  <%= render partial: "shared/catalog_footer_light" %>
</div>

<script>
  const hamburger = document.getElementById('hamburger');
  const navMenu = document.getElementById('navMenu');
  if (hamburger && navMenu) {
    hamburger.addEventListener('click', () => {
      navMenu.classList.toggle('active');
      hamburger.classList.toggle('active');
    });
  }
</script>
